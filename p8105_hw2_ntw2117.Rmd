---
title: "Data Science I: Homework 2"
author: "Nick Williams"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1

#### Importing data

```{r importing data, collapse = TRUE}
nyc_transit_data <- read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
```

#### NYC transit tidying

```{r tidying data, collapse = TRUE}
nyc_transit_data <- nyc_transit_data %>% 
  janitor::clean_names() %>% 
  select(line:entry, 
         vending, 
         ada) 

nyc_transit_data <- nyc_transit_data %>%
  gather(key = route_number, value = route_name, route1:route11) %>%
  separate(route_number,
           into = c("delete", "route_number"),
           sep = 5) %>%
  select(-delete)

nyc_transit_data$entry <- ifelse(nyc_transit_data$entry == "YES", TRUE, FALSE)
```

## Problem 2

#### Importing Mr. Trash Wheel data 

```{r trash wheel import}
trash_wheel_data <- read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                               sheet = "Mr. Trash Wheel", 
                               range = cell_cols("A:N")) 
```

#### Tidying Mr. Trash Wheel

```{r trash wheel tidying}
trash_wheel_data <- trash_wheel_data %>% 
                      janitor::clean_names() %>% 
                      filter(!is.na(dumpster), 
                             month != "Grand Total") %>% 
                      mutate(sports_balls = as.integer(sports_balls))
```

#### Importing and cleaning precipitation data

```{r precipitation data import, collapse = TRUE}
precip_16_data <-
  read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2016 Precipitation", 
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2016)

precip_17_data <- 
  read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2017 Precipitation",
             range = "A2:B10") %>% 
  janitor::clean_names() %>% 
  mutate(year = 2017)
```

#### Combining precipitation data

```{r}
precip_data <- precip_16_data %>% 
               bind_rows(precip_17_data) %>%
               mutate(month = month.name[month])
```

The dataset "trash_wheel_data" has `r nrow(trash_wheel_data)` observations and contains dumpster specific trash content information for the Mr. Trash Wheel in Baltimore from 2014 to 2017. The median number of sports balls in a dumpster in 2017 was `r trash_wheel_data %>% filter(year == "2017") %>% summarise(median(sports_balls))`. The dataset "precip_data" has `r nrow(precip_data)` observations and contains information on the amount of precipitation (in inches) during 2016 and 2017 by month in Baltimore. In 2017, the total precipitation based on available data was `r precip_data %>% filter(year == "2017") %>% summarise(sum(total))` inches.





